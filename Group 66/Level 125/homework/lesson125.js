// GET (áƒ˜áƒœáƒ¤áƒáƒ áƒ›áƒáƒªáƒ˜áƒ˜áƒ¡ áƒ¬áƒáƒ™áƒ˜áƒ—áƒ®áƒ•áƒ)
// áƒ’áƒáƒ›áƒáƒ˜áƒ§áƒ”áƒœáƒ”áƒ‘áƒ áƒ¡áƒ”áƒ áƒ•áƒ”áƒ áƒ˜áƒ“áƒáƒœ áƒ›áƒáƒœáƒáƒªáƒ”áƒ›áƒ”áƒ‘áƒ˜áƒ¡ áƒáƒ›áƒáƒ¡áƒáƒ¦áƒ”áƒ‘áƒáƒ“. áƒ˜áƒ¡ áƒáƒ  áƒªáƒ•áƒšáƒ˜áƒ¡ áƒ¡áƒ”áƒ áƒ•áƒ”áƒ áƒ˜áƒ¡ áƒ›áƒ“áƒ’áƒáƒ›áƒáƒ áƒ”áƒáƒ‘áƒáƒ¡.

// áƒ£áƒ¡áƒáƒ¤áƒ áƒ—áƒ®áƒáƒ”áƒ‘áƒ: áƒ˜áƒ—áƒ•áƒšáƒ”áƒ‘áƒ "áƒ£áƒ¡áƒáƒ¤áƒ áƒ—áƒ®áƒ" áƒ›áƒ”áƒ—áƒáƒ“áƒáƒ“, áƒ áƒáƒ“áƒ’áƒáƒœ áƒ›áƒ®áƒáƒšáƒáƒ“ áƒ™áƒ˜áƒ—áƒ®áƒ£áƒšáƒáƒ‘áƒ¡ áƒ›áƒáƒœáƒáƒªáƒ”áƒ›áƒ”áƒ‘áƒ¡.

// áƒ¥áƒ”áƒ¨áƒ˜áƒ áƒ”áƒ‘áƒ: áƒžáƒáƒ¡áƒ£áƒ®áƒ˜áƒ¡ áƒ¥áƒ”áƒ¨áƒ˜áƒ áƒ”áƒ‘áƒ (Cache) áƒ¨áƒ”áƒ¡áƒáƒ«áƒšáƒ”áƒ‘áƒ”áƒšáƒ˜áƒ.

// áƒ›áƒáƒœáƒáƒªáƒ”áƒ›áƒ”áƒ‘áƒ˜: áƒžáƒáƒ áƒáƒ›áƒ”áƒ¢áƒ áƒ”áƒ‘áƒ˜ áƒ˜áƒ’áƒ–áƒáƒ•áƒœáƒ”áƒ‘áƒ URL-áƒ˜áƒ¡ áƒ¡áƒáƒ¨áƒ£áƒáƒšáƒ”áƒ‘áƒ˜áƒ— (áƒ›áƒáƒ’: site.com/users?id=5).

// 2. POST (áƒ¨áƒ”áƒ¥áƒ›áƒœáƒ)
// áƒ’áƒáƒ›áƒáƒ˜áƒ§áƒ”áƒœáƒ”áƒ‘áƒ áƒ¡áƒ”áƒ áƒ•áƒ”áƒ áƒ–áƒ” áƒáƒ®áƒáƒšáƒ˜ áƒ áƒ”áƒ¡áƒ£áƒ áƒ¡áƒ˜áƒ¡ áƒ¨áƒ”áƒ¡áƒáƒ¥áƒ›áƒœáƒ”áƒšáƒáƒ“. áƒ›áƒáƒ’áƒáƒšáƒ˜áƒ—áƒáƒ“, áƒáƒ®áƒáƒšáƒ˜ áƒ›áƒáƒ›áƒ®áƒ›áƒáƒ áƒ”áƒ‘áƒšáƒ˜áƒ¡ áƒ áƒ”áƒ’áƒ˜áƒ¡áƒ¢áƒ áƒáƒªáƒ˜áƒ áƒáƒœ áƒžáƒáƒ¡áƒ¢áƒ˜áƒ¡ áƒ“áƒáƒ¬áƒ”áƒ áƒ.

// áƒ›áƒáƒœáƒáƒªáƒ”áƒ›áƒ”áƒ‘áƒ˜: áƒ˜áƒ’áƒ–áƒáƒ•áƒœáƒ”áƒ‘áƒ áƒ›áƒáƒ—áƒ®áƒáƒ•áƒœáƒ˜áƒ¡ Body áƒ“áƒ áƒáƒ áƒ URL-áƒ¨áƒ˜.

// áƒ˜áƒ“áƒ”áƒ›áƒžáƒáƒ¢áƒ”áƒœáƒ¢áƒ£áƒ áƒáƒ‘áƒ: áƒáƒ  áƒáƒ áƒ˜áƒ¡ áƒ˜áƒ“áƒ”áƒ›áƒžáƒáƒ¢áƒ”áƒœáƒ¢áƒ£áƒ áƒ˜. áƒ—áƒ£ áƒ”áƒ áƒ—áƒ¡áƒ áƒ“áƒ áƒ˜áƒ›áƒáƒ•áƒ” POST áƒ›áƒáƒ—áƒ®áƒáƒ•áƒœáƒáƒ¡ 5-áƒ¯áƒ”áƒ  áƒ’áƒáƒáƒ’áƒ–áƒáƒ•áƒœáƒ˜áƒ—, áƒ¡áƒ”áƒ áƒ•áƒ”áƒ áƒ–áƒ” 5 áƒáƒ®áƒáƒšáƒ˜ áƒ©áƒáƒœáƒáƒ¬áƒ”áƒ áƒ˜ áƒ¨áƒ”áƒ˜áƒ¥áƒ›áƒœáƒ”áƒ‘áƒ.

// 3. PUT (áƒ¡áƒ áƒ£áƒšáƒ˜ áƒ’áƒáƒœáƒáƒ®áƒšáƒ”áƒ‘áƒ)
// áƒ’áƒáƒ›áƒáƒ˜áƒ§áƒ”áƒœáƒ”áƒ‘áƒ áƒáƒ áƒ¡áƒ”áƒ‘áƒ£áƒšáƒ˜ áƒ áƒ”áƒ¡áƒ£áƒ áƒ¡áƒ˜áƒ¡ áƒ¡áƒ áƒ£áƒšáƒ˜áƒáƒ“ áƒ©áƒáƒ¡áƒáƒœáƒáƒªáƒ•áƒšáƒ”áƒ‘áƒšáƒáƒ“.

// áƒ›áƒ£áƒ¨áƒáƒáƒ‘áƒ˜áƒ¡ áƒžáƒ áƒ˜áƒœáƒªáƒ˜áƒžáƒ˜: áƒ—áƒ¥áƒ•áƒ”áƒœ áƒáƒ’áƒ–áƒáƒ•áƒœáƒ˜áƒ— áƒáƒ‘áƒ˜áƒ”áƒ¥áƒ¢áƒ˜áƒ¡ áƒ¡áƒ áƒ£áƒš áƒ•áƒ”áƒ áƒ¡áƒ˜áƒáƒ¡. áƒ—áƒ£ áƒ áƒ”áƒ¡áƒ£áƒ áƒ¡áƒ˜ áƒáƒ  áƒáƒ áƒ¡áƒ”áƒ‘áƒáƒ‘áƒ¡, áƒ–áƒáƒ’áƒ˜áƒ”áƒ áƒ—áƒ˜ áƒ¡áƒ˜áƒ¡áƒ¢áƒ”áƒ›áƒ áƒ›áƒáƒ¡ áƒ¥áƒ›áƒœáƒ˜áƒ¡.

// áƒ˜áƒ“áƒ”áƒ›áƒžáƒáƒ¢áƒ”áƒœáƒ¢áƒ£áƒ áƒáƒ‘áƒ: áƒáƒ áƒ˜áƒ¡ áƒ˜áƒ“áƒ”áƒ›áƒžáƒáƒ¢áƒ”áƒœáƒ¢áƒ£áƒ áƒ˜. áƒ”áƒ áƒ—áƒ˜ áƒ“áƒ áƒ˜áƒ›áƒáƒ•áƒ” PUT áƒ›áƒáƒ—áƒ®áƒáƒ•áƒœáƒ˜áƒ¡ áƒ›áƒ áƒáƒ•áƒáƒšáƒ¯áƒ”áƒ  áƒ’áƒáƒ’áƒ–áƒáƒ•áƒœáƒ áƒ¨áƒ”áƒ“áƒ”áƒ’áƒ¡ áƒáƒ  áƒªáƒ•áƒšáƒ˜áƒ¡.

// 4. PATCH (áƒœáƒáƒ¬áƒ˜áƒšáƒáƒ‘áƒ áƒ˜áƒ•áƒ˜ áƒ’áƒáƒœáƒáƒ®áƒšáƒ”áƒ‘áƒ)
// áƒ’áƒáƒ›áƒáƒ˜áƒ§áƒ”áƒœáƒ”áƒ‘áƒ áƒ áƒ”áƒ¡áƒ£áƒ áƒ¡áƒ˜áƒ¡ áƒœáƒáƒ¬áƒ˜áƒšáƒáƒ‘áƒ áƒ˜áƒ•áƒ˜ áƒªáƒ•áƒšáƒ˜áƒšáƒ”áƒ‘áƒ˜áƒ¡áƒ—áƒ•áƒ˜áƒ¡.

// áƒ’áƒáƒœáƒ¡áƒ®áƒ•áƒáƒ•áƒ”áƒ‘áƒ PUT-áƒ¡áƒ’áƒáƒœ: áƒ—áƒ£ áƒ›áƒáƒ›áƒ®áƒ›áƒáƒ áƒ”áƒ‘áƒšáƒ˜áƒ¡ áƒ›áƒ®áƒáƒšáƒáƒ“ áƒ”áƒš-áƒ¤áƒáƒ¡áƒ¢áƒ˜áƒ¡ áƒ¨áƒ”áƒªáƒ•áƒšáƒ áƒ’áƒ¡áƒ£áƒ áƒ—, PATCH-áƒ˜áƒ— áƒáƒ’áƒ–áƒáƒ•áƒœáƒ˜áƒ— áƒ›áƒ®áƒáƒšáƒáƒ“ áƒáƒ®áƒáƒš áƒ›áƒ”áƒ˜áƒšáƒ¡. PUT-áƒ˜áƒ¡ áƒ¨áƒ”áƒ›áƒ—áƒ®áƒ•áƒ”áƒ•áƒáƒ¨áƒ˜ áƒ™áƒ˜ áƒ›áƒ—áƒšáƒ˜áƒáƒœáƒ˜ áƒ›áƒáƒ›áƒ®áƒ›áƒáƒ áƒ”áƒ‘áƒšáƒ˜áƒ¡ áƒáƒ‘áƒ˜áƒ”áƒ¥áƒ¢áƒ˜ áƒ£áƒœáƒ“áƒ áƒ’áƒáƒ’áƒ–áƒáƒ•áƒœáƒáƒ—.

// 5. DELETE (áƒ¬áƒáƒ¨áƒšáƒ)
// áƒ’áƒáƒ›áƒáƒ˜áƒ§áƒ”áƒœáƒ”áƒ‘áƒ áƒ›áƒ˜áƒ—áƒ˜áƒ—áƒ”áƒ‘áƒ£áƒšáƒ˜ áƒ áƒ”áƒ¡áƒ£áƒ áƒ¡áƒ˜áƒ¡ áƒ¬áƒáƒ¡áƒáƒ¨áƒšáƒ”áƒšáƒáƒ“.

// áƒ˜áƒ“áƒ”áƒ›áƒžáƒáƒ¢áƒ”áƒœáƒ¢áƒ£áƒ áƒáƒ‘áƒ: áƒáƒ áƒ˜áƒ¡ áƒ˜áƒ“áƒ”áƒ›áƒžáƒáƒ¢áƒ”áƒœáƒ¢áƒ£áƒ áƒ˜. áƒžáƒ˜áƒ áƒ•áƒ”áƒšáƒ˜ áƒ›áƒáƒ—áƒ®áƒáƒ•áƒœáƒ áƒ¬áƒáƒ¨áƒšáƒ˜áƒ¡ áƒ áƒ”áƒ¡áƒ£áƒ áƒ¡áƒ¡, áƒ›áƒáƒ›áƒ“áƒ”áƒ•áƒœáƒ áƒ›áƒáƒ—áƒ®áƒáƒ•áƒœáƒ”áƒ‘áƒ¡ áƒ™áƒ˜ áƒ˜áƒ’áƒ˜áƒ•áƒ” áƒ¨áƒ”áƒ“áƒ”áƒ’áƒ˜ áƒ”áƒ¥áƒœáƒ”áƒ‘áƒ (áƒ áƒ”áƒ¡áƒ£áƒ áƒ¡áƒ˜ áƒáƒ¦áƒáƒ  áƒ˜áƒáƒ áƒ¡áƒ”áƒ‘áƒ”áƒ‘áƒ¡).


const http = require('http');
const fs = require('fs');
const url = require('url');
const path = require('path');

const usersFile = path.join(__dirname, 'users.json');

function getUsers() {
    return JSON.parse(fs.readFileSync(usersFile, 'utf-8'));
}

function saveUsers(users) {
    fs.writeFileSync(usersFile, JSON.stringify(users, null, 2));
}

    const server = http.createServer((req, res) => {
    const parsedUrl = url.parse(req.url, true);
    const { pathname, query } = parsedUrl;

    res.setHeader('Content-Type', 'application/json');

    // ðŸ—‘ DELETE USER (ONLY ADMIN)
    if (pathname === '/delete-user' && req.method === 'DELETE') {
        const { adminEmail, adminPassword, id } = query;

        const users = getUsers();

        // ðŸ” admin-áƒ˜áƒ¡ áƒ¨áƒ”áƒ›áƒáƒ¬áƒ›áƒ”áƒ‘áƒ
        const admin = users.find(
        u =>
            u.email === adminEmail &&
            u.password === adminPassword &&
            u.role === 'admin'
        );

        if (!admin) {
        res.statusCode = 403;
        res.end(JSON.stringify({ message: 'Access denied' }));
        return;
        }

        // ðŸ‘¤ áƒ›áƒáƒ›áƒ®áƒ›áƒáƒ áƒ”áƒ‘áƒšáƒ˜áƒ¡ áƒ›áƒáƒ«áƒ”áƒ‘áƒœáƒ id-áƒ˜áƒ—
        const userIndex = users.findIndex(u => u.id === Number(id));

        if (userIndex === -1) {
        res.statusCode = 404;
        res.end(JSON.stringify({ message: 'User not found' }));
        return;
        }

        // âŒ áƒ¬áƒáƒ¨áƒšáƒ
        const deletedUser = users.splice(userIndex, 1);
        saveUsers(users);

        res.statusCode = 200;
        res.end(
        JSON.stringify({
            message: 'User deleted successfully',
            deletedUser: deletedUser[0]
        })
        );
    }

    else {
        res.statusCode = 404;
        res.end(JSON.stringify({ message: 'Route not found' }));
    }
});

server.listen(3000, () => {
    console.log('Server running on http://localhost:3000');
});
